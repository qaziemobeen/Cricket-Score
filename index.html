<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cricket Tournament Manager</title>
    <style>
        /* [All previous CSS styles remain exactly the same] */
    </style>
</head>
<body>
    <!-- [All previous HTML structure remains exactly the same] -->

    <script>
        // Global tournament data
        let tournament = {
            name: "",
            date: "",
            overs: 5,
            teams: [],
            matches: [],
            standings: {},
            currentMatch: null,
            playersPerTeam: 5
        };

        // [All other variable declarations remain the same]

        // Initialize when page loads - UPDATED TO FIX TEAM COUNT ISSUE
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            document.getElementById('tournament-date').value = today.toISOString().substr(0, 10);
            
            // Initialize with 2 teams and 5 players each
            updateTeams();
            
            // Set up event listeners - FIXED EVENT LISTENERS
            document.getElementById('total-teams').addEventListener('input', function() {
                updateTeams();
            });
            
            document.getElementById('players-per-team').addEventListener('input', function() {
                updatePlayers();
            });
        });

        // UPDATED TEAM MANAGEMENT FUNCTION - NOW WORKING PROPERLY
        function updateTeams() {
            let teamCount = parseInt(document.getElementById('total-teams').value) || 2;
            
            // Validate minimum 2 teams
            if (teamCount < 2) {
                teamCount = 2;
                document.getElementById('total-teams').value = 2;
                alert("Minimum 2 teams required");
            }
            
            const playersPerTeam = parseInt(document.getElementById('players-per-team').value) || 5;
            tournament.playersPerTeam = playersPerTeam;
            
            const teamsContainer = document.getElementById('teams-container');
            teamsContainer.innerHTML = '';
            
            for (let i = 1; i <= teamCount; i++) {
                const teamBox = document.createElement('div');
                teamBox.className = 'team-box';
                
                const teamName = document.createElement('h2');
                const teamNameSpan = document.createElement('span');
                teamNameSpan.className = 'team-name';
                teamNameSpan.contentEditable = true;
                teamNameSpan.textContent = `Team ${String.fromCharCode(64 + i)}`;
                teamName.appendChild(teamNameSpan);
                
                const playerList = document.createElement('div');
                playerList.className = 'player-list';
                playerList.id = `team-${String.fromCharCode(96 + i)}-players`;
                
                for (let j = 1; j <= playersPerTeam; j++) {
                    const player = document.createElement('div');
                    player.className = 'player-item';
                    player.contentEditable = true;
                    player.textContent = `Player ${String.fromCharCode(64 + j)}`;
                    playerList.appendChild(player);
                }
                
                teamBox.appendChild(teamName);
                teamBox.appendChild(playerList);
                teamsContainer.appendChild(teamBox);
            }
        }

        // UPDATED PLAYER MANAGEMENT FUNCTION - NOW WORKING PROPERLY
        function updatePlayers() {
            let playersPerTeam = parseInt(document.getElementById('players-per-team').value) || 5;
            
            // Validate minimum 1 player
            if (playersPerTeam < 1) {
                playersPerTeam = 1;
                document.getElementById('players-per-team').value = 1;
                alert("Minimum 1 player per team required");
            }
            
            tournament.playersPerTeam = playersPerTeam;
            
            const teamContainers = document.querySelectorAll('.player-list');
            teamContainers.forEach(container => {
                container.innerHTML = '';
                for (let i = 1; i <= playersPerTeam; i++) {
                    const player = document.createElement('div');
                    player.className = 'player-item';
                    player.contentEditable = true;
                    player.textContent = `Player ${String.fromCharCode(64 + i)}`;
                    container.appendChild(player);
                }
            });
        }

        // [All other functions remain exactly the same as in the previous working implementation]
    </script>
</body>
</html>
