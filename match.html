<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cricket Match</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Poppins:wght@300;500&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background-color: #f4f6f9;
      color: #333;
      padding: 20px;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
      background-color: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    h1, h2, h3 {
      font-family: 'Roboto', sans-serif;
      color: #2e7d32;
      text-align: center;
      margin-bottom: 20px;
    }

    .match-info {
      background-color: #e8f5e9;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      text-align: center;
      font-size: 18px;
    }

    .toss-container, .scorecard-container {
      background-color: #fff8e1;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .toss-result {
      font-size: 20px;
      font-weight: bold;
      color: #e65100;
      text-align: center;
      margin: 20px 0;
    }

    .flex-container {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }

    .team-section {
      flex: 1;
      background-color: #f5f5f5;
      padding: 15px;
      border-radius: 8px;
    }

    .player-list {
      max-height: 200px;
      overflow-y: auto;
      margin-bottom: 15px;
    }

    .player-item {
      padding: 8px;
      margin: 5px 0;
      background-color: white;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .player-item:hover {
      background-color: #e0e0e0;
    }

    .player-item.selected {
      background-color: #c8e6c9;
      font-weight: bold;
    }

    .player-item.out {
      background-color: #ffcdd2;
      text-decoration: line-through;
    }

    .scoreboard {
      background-color: #e3f2fd;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .scoreboard-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-weight: bold;
    }

    .batsmen-stats, .bowler-stats {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
    }

    .controls {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }

    .extras-controls {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }

    button {
      padding: 12px;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .run-btn {
      background-color: #4caf50;
      color: white;
    }

    .run-btn:hover {
      background-color: #388e3c;
    }

    .wicket-btn {
      background-color: #f44336;
      color: white;
    }

    .wicket-btn:hover {
      background-color: #d32f2f;
    }

    .extra-btn {
      background-color: #ff9800;
      color: white;
    }

    .extra-btn:hover {
      background-color: #f57c00;
    }

    .next-btn {
      background-color: #2196f3;
      color: white;
      display: block;
      margin: 20px auto 0;
      padding: 12px 30px;
    }

    .next-btn:hover {
      background-color: #1976d2;
    }

    .hidden {
      display: none;
    }

    .team-select-btn {
      background-color: #9c27b0;
      color: white;
      width: 200px;
    }

    .team-select-btn:hover {
      background-color: #7b1fa2;
    }

    .method-btn {
      background-color: #607d8b;
      color: white;
    }

    .method-btn:hover {
      background-color: #455a64;
    }

    .score-summary {
      background-color: #e8f5e9;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .over-progress {
      display: flex;
      gap: 5px;
      margin-top: 10px;
    }

    .ball {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background-color: #ddd;
    }

    .ball.legal {
      background-color: #4caf50;
    }

    .ball.wide {
      background-color: #ff9800;
    }

    .ball.noball {
      background-color: #f44336;
    }

    .ball.wicket {
      background-color: #9c27b0;
    }

    .stats-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    .stats-table th, .stats-table td {
      padding: 8px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }

    .stats-table th {
      background-color: #f5f5f5;
    }

    .stats-table tr:nth-child(even) {
      background-color: #f9f9f9;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Cricket Match</h1>
    
    <div class="match-info" id="match-info">
      <!-- Filled by JavaScript -->
    </div>

    <div class="toss-container hidden" id="toss-container">
      <h2>Toss Time!</h2>
      
      <div class="toss-method">
        <button class="method-btn" onclick="showAutoToss()">Simulate Toss</button>
        <button class="method-btn" onclick="showManualToss()">Manual Selection</button>
      </div>

      <div id="auto-toss" class="hidden">
        <p>Click the button to simulate the toss between the two teams:</p>
        <div style="text-align: center;">
          <button class="toss-btn" onclick="simulateToss()">Do the Toss</button>
        </div>
      </div>

      <div id="manual-toss" class="hidden">
        <p>Select which team won the toss:</p>
        <div class="toss-options">
          <button class="team-select-btn" id="team1-btn" onclick="manualTossWinner(this)"></button>
          <button class="team-select-btn" id="team2-btn" onclick="manualTossWinner(this)"></button>
        </div>
      </div>

      <div class="toss-result hidden" id="toss-result">
        <!-- Filled by JavaScript -->
      </div>

      <div class="hidden" id="toss-decision">
        <p>What does the winning team choose to do?</p>
        <div class="toss-options">
          <button class="bat-btn" onclick="chooseBat('bat')">Bat First</button>
          <button class="bowl-btn" onclick="chooseBat('bowl')">Bowl First</button>
        </div>
      </div>
    </div>

    <div class="hidden" id="scorecard-container">
      <div class="score-summary">
        <h2 id="innings-title">1st Innings</h2>
        <div id="score-display">0/0 (0.0 overs)</div>
        <div class="over-progress" id="over-progress"></div>
      </div>

      <div class="flex-container">
        <div class="team-section">
          <h3 id="batting-team-name">Batting Team</h3>
          <div class="player-list" id="batsmen-list"></div>
          <button class="next-btn" onclick="swapBatsmen()">Swap Striker</button>
        </div>

        <div class="team-section">
          <h3 id="bowling-team-name">Bowling Team</h3>
          <div class="player-list" id="bowlers-list"></div>
        </div>
      </div>

      <div class="scoreboard">
        <div class="scoreboard-header">
          <span>Batsman</span>
          <span>R</span>
          <span>B</span>
          <span>4s</span>
          <span>6s</span>
          <span>SR</span>
        </div>
        <div id="batsmen-stats"></div>
      </div>

      <div class="scoreboard">
        <div class="scoreboard-header">
          <span>Bowler</span>
          <span>O</span>
          <span>M</span>
          <span>R</span>
          <span>W</span>
          <span>ER</span>
        </div>
        <div id="bowler-stats"></div>
      </div>

      <div class="controls">
        <button class="run-btn" onclick="addRuns(0)">Dot</button>
        <button class="run-btn" onclick="addRuns(1)">1</button>
        <button class="run-btn" onclick="addRuns(2)">2</button>
        <button class="run-btn" onclick="addRuns(3)">3</button>
        <button class="run-btn" onclick="addRuns(4)">4</button>
        <button class="run-btn" onclick="addRuns(6)">6</button>
        <button class="wicket-btn" onclick="showWicketOptions()">Wicket</button>
        <button class="extra-btn" onclick="showExtraOptions('wide')">Wide</button>
        <button class="extra-btn" onclick="showExtraOptions('noball')">No Ball</button>
      </div>

      <div class="hidden" id="wicket-options">
        <h3>Select Wicket Type</h3>
        <div class="controls">
          <button class="wicket-btn" onclick="addWicket('bowled')">Bowled</button>
          <button class="wicket-btn" onclick="addWicket('caught')">Caught</button>
          <button class="wicket-btn" onclick="addWicket('lbw')">LBW</button>
          <button class="wicket-btn" onclick="addWicket('runout')">Run Out</button>
          <button class="wicket-btn" onclick="addWicket('stumped')">Stumped</button>
          <button class="wicket-btn" onclick="cancelWicket()">Cancel</button>
        </div>
      </div>

      <div class="hidden" id="extra-options">
        <h3 id="extra-options-title">Extra Runs</h3>
        <div class="extras-controls">
          <button class="run-btn" onclick="addExtra(1)">1</button>
          <button class="run-btn" onclick="addExtra(2)">2</button>
          <button class="run-btn" onclick="addExtra(3)">3</button>
          <button class="run-btn" onclick="addExtra(4)">4</button>
          <button class="run-btn" onclick="addExtra(6)">6</button>
          <button class="wicket-btn" onclick="addExtraWicket()">+ Wicket</button>
          <button class="extra-btn" onclick="cancelExtra()">Cancel</button>
        </div>
      </div>

      <div class="hidden" id="match-end">
        <h2>Innings Complete!</h2>
        <div id="innings-summary"></div>
        <button class="next-btn" onclick="startNextInnings()">Start Next Innings</button>
      </div>

      <div class="hidden" id="match-complete">
        <h2>Match Complete!</h2>
        <div id="match-result"></div>
        <button class="next-btn" onclick="returnToTournament()">Return to Tournament</button>
      </div>
    </div>
  </div>

  <script>
    // Get teams from URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    const team1Name = decodeURIComponent(urlParams.get('team1'));
    const team2Name = decodeURIComponent(urlParams.get('team2'));
    const matchNo = urlParams.get('matchNo');

    // Match state
    let matchState = {
      tossWinner: null,
      tossChoice: null,
      battingTeam: null,
      bowlingTeam: null,
      currentInnings: 1,
      innings: [],
      currentBowler: null,
      bowlersUsed: [],
      overHistory: [],
      extraType: null
    };

    // Initialize teams with players
    let teams = {
      [team1Name]: Array(parseInt(urlParams.get('team1Players')) || 3).fill().map((_, i) => ({
        name: `Player ${i+1}`,
        batting: { runs: 0, balls: 0, fours: 0, sixes: 0, out: false },
        bowling: { overs: 0, maidens: 0, runs: 0, wickets: 0, balls: 0 }
      })),
      [team2Name]: Array(parseInt(urlParams.get('team2Players')) || 3).fill().map((_, i) => ({
        name: `Player ${i+1}`,
        batting: { runs: 0, balls: 0, fours: 0, sixes: 0, out: false },
        bowling: { overs: 0, maidens: 0, runs: 0, wickets: 0, balls: 0 }
      }))
    };

    // Set match info and manual selection buttons
    document.getElementById('match-info').innerHTML = `
      <strong>Match ${matchNo}</strong>: ${team1Name} vs ${team2Name}
    `;
    document.getElementById('team1-btn').textContent = team1Name;
    document.getElementById('team2-btn').textContent = team2Name;

    // Show toss container by default
    document.getElementById('toss-container').classList.remove('hidden');

    function showAutoToss() {
      document.getElementById('auto-toss').classList.remove('hidden');
      document.getElementById('manual-toss').classList.add('hidden');
    }

    function showManualToss() {
      document.getElementById('manual-toss').classList.remove('hidden');
      document.getElementById('auto-toss').classList.add('hidden');
    }

    function manualTossWinner(button) {
      matchState.tossWinner = button.textContent;
      document.getElementById('toss-result').innerHTML = `
        ${matchState.tossWinner} won the toss!
      `;
      document.getElementById('toss-result').classList.remove('hidden');
      document.getElementById('toss-decision').classList.remove('hidden');
      document.getElementById('manual-toss').classList.add('hidden');
    }

    function simulateToss() {
      // Randomly select winning team (50/50 chance)
      matchState.tossWinner = Math.random() < 0.5 ? team1Name : team2Name;
      
      document.getElementById('toss-result').innerHTML = `
        ${matchState.tossWinner} won the toss!
      `;
      
      document.getElementById('toss-result').classList.remove('hidden');
      document.getElementById('toss-decision').classList.remove('hidden');
      document.getElementById('auto-toss').classList.add('hidden');
    }

    function chooseBat(choice) {
      matchState.tossChoice = choice;
      
      // Set batting and bowling teams based on toss
      if (choice === 'bat') {
        matchState.battingTeam = matchState.tossWinner;
        matchState.bowlingTeam = matchState.tossWinner === team1Name ? team2Name : team1Name;
      } else {
        matchState.bowlingTeam = matchState.tossWinner;
        matchState.battingTeam = matchState.tossWinner === team1Name ? team2Name : team1Name;
      }
      
      // Initialize first innings
      startInnings();
    }

    function startInnings() {
      document.getElementById('toss-container').classList.add('hidden');
      document.getElementById('scorecard-container').classList.remove('hidden');
      
      // Set innings title
      document.getElementById('innings-title').textContent = 
        matchState.currentInnings === 1 ? '1st Innings' : '2nd Innings';
      
      // Set team names
      document.getElementById('batting-team-name').textContent = matchState.battingTeam;
      document.getElementById('bowling-team-name').textContent = matchState.bowlingTeam;
      
      // Initialize innings state
      matchState.innings[matchState.currentInnings-1] = {
        runs: 0,
        wickets: 0,
        overs: 0,
        balls: 0,
        extras: { wides: 0, noballs: 0, byes: 0, legbyes: 0 },
        batsmen: [],
        bowlers: []
      };
      
      // Render player lists
      renderPlayerLists();
      
      // Update score display
      updateScoreDisplay();
    }

    function renderPlayerLists() {
      const batsmenList = document.getElementById('batsmen-list');
      const bowlersList = document.getElementById('bowlers-list');
      
      // Clear existing lists
      batsmenList.innerHTML = '';
      bowlersList.innerHTML = '';
      
      // Add batsmen (only those not out)
      teams[matchState.battingTeam].forEach((player, index) => {
        if (!player.batting.out) {
          const playerItem = document.createElement('div');
          playerItem.className = 'player-item';
          playerItem.textContent = player.name;
          playerItem.dataset.index = index;
          playerItem.onclick = () => selectBatsman(index);
          
          // Highlight if already selected
          if (matchState.innings[matchState.currentInnings-1].batsmen.includes(index)) {
            playerItem.classList.add('selected');
          }
          
          batsmenList.appendChild(playerItem);
        }
      });
      
      // Add bowlers (only those who haven't bowled their quota)
      teams[matchState.bowlingTeam].forEach((player, index) => {
        if (player.bowling.overs < 2) { // Assuming max 2 overs per bowler
          const playerItem = document.createElement('div');
          playerItem.className = 'player-item';
          playerItem.textContent = player.name;
          playerItem.dataset.index = index;
          playerItem.onclick = () => selectBowler(index);
          
          // Highlight if current bowler
          if (index === matchState.currentBowler) {
            playerItem.classList.add('selected');
          }
          
          bowlersList.appendChild(playerItem);
        }
      });
      
      // Update stats displays
      updateBatsmenStats();
      updateBowlerStats();
    }

    function selectBatsman(index) {
      const innings = matchState.innings[matchState.currentInnings-1];
      
      // If we already have 2 batsmen, don't select more
      if (innings.batsmen.length >= 2 && !innings.batsmen.includes(index)) return;
      
      // Toggle selection
      if (innings.batsmen.includes(index)) {
        innings.batsmen = innings.batsmen.filter(i => i !== index);
      } else {
        innings.batsmen.push(index);
      }
      
      // If we have exactly 2 batsmen, set the striker (first selected)
      if (innings.batsmen.length === 2 && !innings.striker !== undefined) {
        innings.striker = innings.batsmen[0];
        innings.nonStriker = innings.batsmen[1];
      }
      
      renderPlayerLists();
    }

    function selectBowler(index) {
      matchState.currentBowler = index;
      renderPlayerLists();
    }

    function swapBatsmen() {
      const innings = matchState.innings[matchState.currentInnings-1];
      if (innings.striker === undefined || innings.nonStriker === undefined) return;
      
      // Swap striker and non-striker
      const temp = innings.striker;
      innings.striker = innings.nonStriker;
      innings.nonStriker = temp;
      
      updateBatsmenStats();
    }

    function addRuns(runs) {
      const innings = matchState.innings[matchState.currentInnings-1];
      const strikerIndex = innings.striker;
      
      if (strikerIndex === undefined || matchState.currentBowler === null) {
        alert('Please select both batsmen and a bowler first');
        return;
      }
      
      // Add runs to batsman
      const striker = teams[matchState.battingTeam][strikerIndex];
      striker.batting.runs += runs;
      striker.batting.balls++;
      if (runs === 4) striker.batting.fours++;
      if (runs === 6) striker.batting.sixes++;
      
      // Add runs to bowler
      const bowler = teams[matchState.bowlingTeam][matchState.currentBowler];
      bowler.bowling.runs += runs;
      bowler.bowling.balls++;
      
      // Add to innings total
      innings.runs += runs;
      innings.balls++;
      
      // Update over progress
      updateOverProgress();
      
      // Update displays
      updateScoreDisplay();
      updateBatsmenStats();
      updateBowlerStats();
      
      // Check for over completion
      checkOverCompletion();
    }

    function showWicketOptions() {
      document.getElementById('wicket-options').classList.remove('hidden');
    }

    function addWicket(type) {
      const innings = matchState.innings[matchState.currentInnings-1];
      const strikerIndex = innings.striker;
      
      if (strikerIndex === undefined || matchState.currentBowler === null) {
        alert('Please select both batsmen and a bowler first');
        return;
      }
      
      // Mark batsman as out
      const striker = teams[matchState.battingTeam][strikerIndex];
      striker.batting.out = true;
      
      // Add wicket to bowler
      const bowler = teams[matchState.bowlingTeam][matchState.currentBowler];
      bowler.bowling.wickets++;
      bowler.bowling.balls++;
      
      // Add to innings totals
      innings.wickets++;
      innings.balls++;
      
      // Update over progress
      updateOverProgress();
      
      // Remove the out batsman from selection
      innings.batsmen = innings.batsmen.filter(i => i !== strikerIndex);
      innings.striker = undefined;
      
      // Check if innings is over
      if (innings.wickets >= teams[matchState.battingTeam].length - 1) {
        endInnings();
        return;
      }
      
      // Update displays
      updateScoreDisplay();
      updateBatsmenStats();
      updateBowlerStats();
      
      // Hide wicket options
      document.getElementById('wicket-options').classList.add('hidden');
      
      // Check for over completion
      checkOverCompletion();
    }

    function cancelWicket() {
      document.getElementById('wicket-options').classList.add('hidden');
    }

    function showExtraOptions(type) {
      matchState.extraType = type;
      document.getElementById('extra-options-title').textContent = 
        type === 'wide' ? 'Wide - Add Runs' : 'No Ball - Add Runs';
      document.getElementById('extra-options').classList.remove('hidden');
    }

    function addExtra(runs) {
      const innings = matchState.innings[matchState.currentInnings-1];
      
      // Add extra runs
      innings.runs += runs + 1; // 1 for the extra itself
      if (matchState.extraType === 'wide') {
        innings.extras.wides += 1;
      } else {
        innings.extras.noballs += 1;
      }
      
      // Add runs to bowler (only for no balls, wides don't count against bowler)
      if (matchState.extraType === 'noball') {
        const bowler = teams[matchState.bowlingTeam][matchState.currentBowler];
        bowler.bowling.runs += runs + 1;
      }
      
      // Update displays
      updateScoreDisplay();
      updateBowlerStats();
      
      // Hide extra options
      document.getElementById('extra-options').classList.add('hidden');
    }

    function addExtraWicket() {
      // First add the extra
      addExtra(0);
      
      // Then add wicket
      showWicketOptions();
    }

    function cancelExtra() {
      matchState.extraType = null;
      document.getElementById('extra-options').classList.add('hidden');
    }

    function updateOverProgress() {
      const innings = matchState.innings[matchState.currentInnings-1];
      const overProgress = document.getElementById('over-progress');
      overProgress.innerHTML = '';
      
      const ballsInOver = innings.balls % 6;
      for (let i = 0; i < 6; i++) {
        const ball = document.createElement('div');
        ball.className = 'ball';
        
        // Color based on ball result (simplified for this example)
        if (i < ballsInOver) {
          ball.classList.add('legal');
        }
        
        overProgress.appendChild(ball);
      }
    }

    function checkOverCompletion() {
      const innings = matchState.innings[matchState.currentInnings-1];
      
      if (innings.balls % 6 === 0 && innings.balls > 0) {
        // Over completed
        const bowler = teams[matchState.bowlingTeam][matchState.currentBowler];
        bowler.bowling.overs += 1;
        
        // Check for maiden over
        if (bowler.bowling.balls % 6 === 0 && bowler.bowling.runs === 0) {
          bowler.bowling.maidens += 1;
        }
        
        // Swap striker and non-striker
        const temp = innings.striker;
        innings.striker = innings.nonStriker;
        innings.nonStriker = temp;
        
        // Reset for new over
        matchState.currentBowler = null;
        
        // Update displays
        updateBowlerStats();
        renderPlayerLists();
      }
    }

    function updateScoreDisplay() {
      const innings = matchState.innings[matchState.currentInnings-1];
      const overs = Math.floor(innings.balls / 6);
      const balls = innings.balls % 6;
      document.getElementById('score-display').textContent = 
        `${innings.runs}/${innings.wickets} (${overs}.${balls} overs)`;
    }

    function updateBatsmenStats() {
      const innings = matchState.innings[matchState.currentInnings-1];
      const container = document.getElementById('batsmen-stats');
      container.innerHTML = '';
      
      // Add striker first
      if (innings.striker !== undefined) {
        const batsman = teams[matchState.battingTeam][innings.striker];
        const sr = batsman.batting.balls > 0 ? 
          ((batsman.batting.runs / batsman.batting.balls) * 100).toFixed(2) : '0.00';
        
        const statRow = document.createElement('div');
        statRow.className = 'batsmen-stats';
        statRow.innerHTML = `
          <span>${batsman.name} *</span>
          <span>${batsman.batting.runs}</span>
          <span>${batsman.batting.balls}</span>
          <span>${batsman.batting.fours}</span>
          <span>${batsman.batting.sixes}</span>
          <span>${sr}</span>
        `;
        container.appendChild(statRow);
      }
      
      // Add non-striker
      if (innings.nonStriker !== undefined) {
        const batsman = teams[matchState.battingTeam][innings.nonStriker];
        const sr = batsman.batting.balls > 0 ? 
          ((batsman.batting.runs / batsman.batting.balls) * 100).toFixed(2) : '0.00';
        
        const statRow = document.createElement('div');
        statRow.className = 'batsmen-stats';
        statRow.innerHTML = `
          <span>${batsman.name}</span>
          <span>${batsman.batting.runs}</span>
          <span>${batsman.batting.balls}</span>
          <span>${batsman.batting.fours}</span>
          <span>${batsman.batting.sixes}</span>
          <span>${sr}</span>
        `;
        container.appendChild(statRow);
      }
      
      // Add other batsmen who are out
      teams[matchState.battingTeam].forEach((player, index) => {
        if (player.batting.out && index !== innings.striker && index !== innings.nonStriker) {
          const sr = player.batting.balls > 0 ? 
            ((player.batting.runs / player.batting.balls) * 100).toFixed(2) : '0.00';
          
          const statRow = document.createElement('div');
          statRow.className = 'batsmen-stats';
          statRow.innerHTML = `
            <span>${player.name} (out)</span>
            <span>${player.batting.runs}</span>
            <span>${player.batting.balls}</span>
            <span>${player.batting.fours}</span>
            <span>${player.batting.sixes}</span>
            <span>${sr}</span>
          `;
          container.appendChild(statRow);
        }
      });
    }

    function updateBowlerStats() {
      const container = document.getElementById('bowler-stats');
      container.innerHTML = '';
      
      // Add current bowler first
      if (matchState.currentBowler !== null) {
        const bowler = teams[matchState.bowlingTeam][matchState.currentBowler];
        const er = bowler.bowling.balls > 0 ? 
          ((bowler.bowling.runs / bowler.bowling.balls) * 6).toFixed(2) : '0.00';
        
        const statRow = document.createElement('div');
        statRow.className = 'bowler-stats';
        statRow.innerHTML = `
          <span>${bowler.name} *</span>
          <span>${bowler.bowling.overs}.${bowler.bowling.balls % 6}</span>
          <span>${bowler.bowling.maidens}</span>
          <span>${bowler.bowling.runs}</span>
          <span>${bowler.bowling.wickets}</span>
          <span>${er}</span>
        `;
        container.appendChild(statRow);
      }
      
      // Add other bowlers who have bowled
      teams[matchState.bowlingTeam].forEach((player, index) => {
        if (player.bowling.balls > 0 && index !== matchState.currentBowler) {
          const er = player.bowling.balls > 0 ? 
            ((player.bowling.runs / player.bowling.balls) * 6).toFixed(2) : '0.00';
          
          const statRow = document.createElement('div');
          statRow.className = 'bowler-stats';
          statRow.innerHTML = `
            <span>${player.name}</span>
            <span>${player.bowling.overs}.${player.bowling.balls % 6}</span>
            <span>${player.bowling.maidens}</span>
            <span>${player.bowling.runs}</span>
            <span>${player.bowling.wickets}</span>
            <span>${er}</span>
          `;
          container.appendChild(statRow);
        }
      });
    }

    function endInnings() {
      document.getElementById('scorecard-container').classList.add('hidden');
      document.getElementById('match-end').classList.remove('hidden');
      
      const innings = matchState.innings[matchState.currentInnings-1];
      const summary = document.getElementById('innings-summary');
      summary.innerHTML = `
        <p><strong>${matchState.battingTeam}:</strong> ${innings.runs}/${innings.wickets} in ${Math.floor(innings.balls/6)}.${innings.balls%6} overs</p>
        <p>Extras: ${innings.extras.wides} wides, ${innings.extras.noballs} no balls</p>
      `;
    }

    function startNextInnings() {
      if (matchState.currentInnings === 1) {
        // Swap teams for 2nd innings
        const temp = matchState.battingTeam;
        matchState.battingTeam = matchState.bowlingTeam;
        matchState.bowlingTeam = temp;
        
        matchState.currentInnings = 2;
        document.getElementById('match-end').classList.add('hidden');
        startInnings();
      } else {
        // Match complete
        endMatch();
      }
    }

    function endMatch() {
      document.getElementById('match-end').classList.add('hidden');
      document.getElementById('match-complete').classList.remove('hidden');
      
      const result = document.getElementById('match-result');
      const innings1 = matchState.innings[0];
      const innings2 = matchState.innings[1];
      
      if (innings1.runs > innings2.runs) {
        result.innerHTML = `
          <p><strong>${matchState.innings[0].battingTeam} won by ${innings1.runs - innings2.runs} runs</strong></p>
          <p>${matchState.innings[0].battingTeam}: ${innings1.runs}/${innings1.wickets}</p>
          <p>${matchState.innings[1].battingTeam}: ${innings2.runs}/${innings2.wickets}</p>
        `;
      } else if (innings2.runs > innings1.runs) {
        result.innerHTML = `
          <p><strong>${matchState.innings[1].battingTeam} won by ${teams[matchState.bowlingTeam].length - innings2.wickets} wickets</strong></p>
          <p>${matchState.innings[0].battingTeam}: ${innings1.runs}/${innings1.wickets}</p>
          <p>${matchState.innings[1].battingTeam}: ${innings2.runs}/${innings2.wickets}</p>
        `;
      } else {
        result.innerHTML = `
          <p><strong>Match tied!</strong></p>
          <p>${matchState.innings[0].battingTeam}: ${innings1.runs}/${innings1.wickets}</p>
          <p>${matchState.innings[1].battingTeam}: ${innings2.runs}/${innings2.wickets}</p>
        `;
      }
    }

    function returnToTournament() {
      window.location.href = 'tournament.html';
    }
  </script>
</body>
</html>
